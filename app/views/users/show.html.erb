<div class='container text-center'>
  <h3>
    <%= current_user['name'] %>'s Greenhouse
  </h3>
  <div class="spacer-2"></div>
  <%= button_to 'Plant a Fern', new_fern_path, method: :get, class: 'btn btn-lg btn-primary' %>
  <div class="spacer-1"></div>
</div>
<div class='container'>
  <% if @shelves %>
    <% if @shelves.all? { |shelf| shelf.ferns.empty? } %>
      <%= render partial: '/partials/instructions' %>
    <% end %>
    <% @shelves.each do |shelf| %>
      <% unless shelf.ferns == [] %>
        <div class="shelf-sign text-center">
          <h4 class="shelf"><%= shelf.name %> Shelf</h4>
        </div>
        <div id="<%= shelf.name.downcase %>">
        <% if shelf.ferns.length > 2 %>
          <% split_index = 0 %>
          <% (shelf.ferns.length / 3).times do %>
            <div class="has-bg-img row">
              <% single_shelf = shelf.ferns.slice(split_index, 3) %>
              <% split_index += 3 %>
              <% single_shelf.each do |fern| %>
                <div class="col-sm-4 text-center greenhouse-fern" id=<%=fern.id%>-<%=fern.name%>>
                  <%= link_to image_tag(fern.image, size: 200, alt: 'fern health image', id: "fern-#{fern.id}"), fern_path(fern.id) %><br>
                  <p><%= fern.name %></p>
                </div>
              <% end %>
            </div>
          <% end %>
          <% if (shelf.ferns.length % 3) > 0 %>
            <div class="has-bg-img row">
              <% single_shelf = shelf.ferns.slice((shelf.ferns.index(shelf.ferns.last) - (shelf.ferns.length % 3) + 1), (shelf.ferns.length % 3)) %>
              <% single_shelf.each do |fern| %>
                <div class="col-sm-4 text-center greenhouse-fern" id=<%=fern.id%>-<%=fern.name%>>
                  <%= link_to image_tag(fern.image, size: 200, alt: 'fern health image', id: "fern-#{fern.id}"), fern_path(fern.id) %><br>
                  <p><%= fern.name %></p>
                </div>
              <% end %>
            </div>
          <% end %>
        <% else %>
          <div class="has-bg-img row">
            <% shelf.ferns.each do |fern| %>
              <div class="col-sm-4 text-center greenhouse-fern" id=<%=fern.id%>-<%=fern.name%>>
                <%= link_to image_tag(fern.image, size: 200, alt: 'fern health image', id: "fern-#{fern.id}"), fern_path(fern.id) %><br>
                <p><%= fern.name %></p>
              </div>
            <% end %>
          </div>
        <% end %>
      <% end %>
      </div>
    <% end %>
  <% end %>
</div>
